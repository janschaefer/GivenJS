#!/usr/bin/env node

'use strict';

var fs = require('fs-extra');

var program = require('commander');
var path = require('path');
var glob = require('glob');
var	version = require('../package.json').version;

var sourceDir;

program
	.version(version)
	.usage('[options] <jsonFiles>')
	.option('-t, --targetDir <targetDir>', 'the target directory to generate the HTML report to','givenjs-html-report')
	.parse(process.argv);

if (program.args.length === 0) {
	console.log(program.helpInformation());
	process.exit(1);
}

var targetDir = program.targetDir;

console.log("Target Directory: "+targetDir);

var jsonInputs = [];

console.log("Creating "+targetDir);
fs.mkdirpSync(targetDir);

console.log("Copy static data to "+targetDir);

glob(__dirname+"/../app", function( err, files ) {
	files.forEach( function (file) {
		fs.copySync(file, targetDir);
	});
});

program.args.forEach( function( arg ) {
	glob(arg, function (err, files) {
		files.forEach(function (file) {
			console.log("Reading "+file);
			jsonInputs.push(JSON.parse(fs.readFileSync(file, "utf8")));
		});
	});
});


